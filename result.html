<!DOCTYPE html>
<html>
<head>
<title>My Valentine ❤️</title>

<style>
body{
 background:#ffe6ec;
 font-family:Segoe UI;
 text-align:center;
 overflow:hidden;
}

#preview{
 width:380px;
 height:380px;
 margin:auto;
 position:relative;
}

/* Image */
#photo{
 width:300px;
 height:300px;
 border-radius:50%;
 margin-top:40px;
 border:10px solid gold;
 object-fit:cover;
}

/* Frames */
.gold{border-color:gold;}
.rose{border-color:deeppink;}
.heart{border-color:red;box-shadow:0 0 20px red;}

/* Hearts */
.heartFloat{
 position:absolute;
 font-size:24px;
 animation:float 3s infinite;
}

@keyframes float{
 0%{transform:translateY(0);}
 50%{transform:translateY(-20px);}
 100%{transform:translateY(0);}
}

/* Sparkles */
.sparkle{
 position:absolute;
 width:4px;
 height:4px;
 background:white;
 border-radius:50%;
 animation:twinkle 2s infinite;
}

@keyframes twinkle{
 0%{opacity:0;}
 50%{opacity:1;}
 100%{opacity:0;}
}

/* Quote Circle */
#circle{
 width:380px;
 height:380px;
 position:absolute;
 animation:rotate 20s linear infinite;
}

@keyframes rotate{
 from{transform:rotate(0deg);}
 to{transform:rotate(360deg);}
}

.quote{
 position:absolute;
 font-size:15px;
 color:darkred;
}

/* Text */
#title{
 color:red;
 font-size:26px;
 text-shadow:0 0 10px pink;
}
</style>
</head>

<body>

<div id="preview">

 <div id="circle"></div>

 <img id="photo">

 <h3 id="title"></h3>
 <p id="custom"></p>

</div>

<br>

<button onclick="playMusic()">▶ Music</button>
<button onclick="download()">Download</button>
<button onclick="printImg()">Print</button>

<audio id="bgm" src="music.mp3" muted loop></audio>

<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

<script>

const quotes=[
 "You are my forever ❤️",
 "My heart is yours",
 "Love you always",
 "You complete me",
 "Together forever"
];

window.onload=function(){

 let name=localStorage.getItem("v_name");
 let msg=localStorage.getItem("v_msg");
 let frame=localStorage.getItem("v_frame");
 let img=localStorage.getItem("v_img");

 photo.src=img;
 photo.className=frame;

 title.innerText="Happy Valentine's Day "+name+" ❤️";
 custom.innerText=msg;

 addHearts();
 addSparkles();
 addQuotes();
}

/* Effects */

function addHearts(){
 for(let i=0;i<10;i++){
  let h=document.createElement("div");
  h.className="heartFloat";
  h.innerHTML="❤️";
  h.style.left=Math.random()*350+"px";
  h.style.top=Math.random()*350+"px";
  preview.appendChild(h);
 }
}

function addSparkles(){
 for(let i=0;i<40;i++){
  let s=document.createElement("div");
  s.className="sparkle";
  s.style.left=Math.random()*380+"px";
  s.style.top=Math.random()*380+"px";
  preview.appendChild(s);
 }
}

function addQuotes(){

 quotes.forEach((q,i)=>{

  let d=document.createElement("div");
  d.className="quote";
  d.innerText=q;

  let angle=(360/quotes.length)*i;
  let r=170;

  d.style.transform=
   `rotate(${angle}deg)
    translate(${r}px)
    rotate(-${angle}deg)`;

  circle.appendChild(d);
 });
}

/* Music */

function playMusic(){
 let m=bgm;
 m.muted=false;
 m.play();
}

/* Export */

function download(){

 html2canvas(preview).then(c=>{

  let a=document.createElement("a");
  a.download="valentine.png";
  a.href=c.toDataURL();
  a.click();

 });
}

function printImg(){

 html2canvas(preview).then(c=>{

  let w=window.open("");
  w.document.write("<img src='"+c.toDataURL()+"'>");
  w.print();

 });
}

</script>

</body>
</html>
